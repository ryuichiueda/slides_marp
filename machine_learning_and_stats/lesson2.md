---
marp: true
---

<!-- footer: "機械学習（と統計）第2回" -->

# 機械学習

## 第2回: 確率と期待値による判断や決定

千葉工業大学 上田 隆一

<br />

<span style="font-size:70%">This work is licensed under a </span>[<span style="font-size:70%">Creative Commons Attribution-ShareAlike 4.0 International License</span>](https://creativecommons.org/licenses/by-sa/4.0/).
![](https://i.creativecommons.org/l/by-sa/4.0/88x31.png)

---

<!-- paginate: true -->

## 今日やること

- 確率の使い方
- 期待値の使い方
- 期待値の利用


---

## 確率の使い方

---

### 確率ってなに？結局なんなのか?

- よくある例
    - コインを投げて表が出る確率は1/2
    - サイコロを振って1の目が出る確率は1/6
- こう考えましょう
    - 確率: 全通りの未来に対して、ある未来が選ばれる割合
        - あるいはどうなったか知らない過去のことについて、選ばれた割合


---

### 確率の表記

- 確率は$\text{Pr}\{$事象$\}$という記号を使って表記
    - <span style="color:red">事象</span>: 起きる（た）こと
    - いろいろ書き方があるがこの講義ではこう表記
        - 後日$P$という表記も出てくるけど別物
- 例: コインの裏表
    - $\text{Pr}\{$表が出る$\} = 1/2$
    - $\text{Pr}\{$裏が出る$\} = 1/2$
    - $\text{Pr}\{$裏か裏が出る$\} = \text{Pr}\{$表が出る$\} +\text{Pr}\{$裏が出る$\} = 1$
    - 注意: 別にすべてのコインがこうなるわけでないので、実は「こういうコインの<span style="color:red">モデル</span>を考えましょう」という話でコレ自体に根拠はない


---

### 確率の計算

- 実は足し算と掛け算しかない
- 足し算（<span style="color:red">加法定理</span>）
    - $\text{Pr}\{$AとBが起きる$\} = \text{Pr}\{$Aが起きる$\} +\text{Pr}\{$Bが起きる$\}$
        - ただしAとBは同時に起きないように定義する必要がある
- 掛け算（<span style="color:red">乗法定理</span>）
    - $\text{Pr}\{$AとBが起きる$\} = \text{Pr}\{$Aが起きる|Bが起きる$\}\text{Pr}\{$Bが起きる$\}$
        - $\text{Pr}\{$Aが起きる|Bが起きる$\}$: Bが起きることが分かっているときに
        Aが起きる確率（<span style="color:red">条件付き確率</span>）
            - $|$の右側は「<span style="color:red">条件</span>」


<center>よく分からんのでサイコロで考えましょう</center>

---

### 確率の計算の問題（その1）

- 1または2が出ている
    * $\text{Pr}\{1$と$2\} = \text{Pr}\{1\} + \text{Pr}\{2\} = 1/6 + 1/6 = 1/3$
        - 1と2は同時には出ないから足せる
- 1つめのサイコロが1で、2つめのサイコロが6
（$\text{D}_1=1, \text{D}_2=6$と表記しましょう）
    * $\text{Pr}\{\text{D}_1=1, \text{D}_2=6\} = \text{Pr}\{\text{D}_1=1 | \text{D}_2=6\}\Pr\{\text{D}_2=6\}$
    $= \text{Pr}\{\text{D}_1=1\}\Pr\{\text{D}_2=6\}$
    （↑2つのサイコロの目は無関係なので条件を消せる）
    $= 1/6 \cdot 1/6 = 1/36$

---

### 確率の計算のポイント

- 計算自体は全然難しくない
- 大変なこと
    - 加法定理での、ある事象とある事象が同時に起こるかどうかの判断
        - 事象が同時に起こらないことを<span style="color:red">排反</span>と呼ぶ
    - 乗法定理での、条件を消せるかどうかの判断
       - ある事象がある事象の条件として影響を与えないことを<span style="color:red">独立</span>と呼ぶ
- 練習問題
    - [同時確率と条件付き確率](https://b.ueda.tech/?page=robot_and_stats_questions#同時確率と条件付き確率)

---

### 確率による判断

- 引き続き、代表値で誰を代表にするか議論しましょう
    - 前回提示したデータ
        - Aさん: 134, 93, 123, 110, 98
        - Bさん: 84, 78, 92, 210
        - Cさん: 42, 138, 134, 99, 145
    - 前回: 代表値で誰を代表にするか議論した$\rightarrow$理屈では決まらなかった
- 追加情報
    - 代表者が参加する大会は、200点をとればほぼ優勝で、
    130点をとればほぼ入賞
        - A, B, Cさんの優勝の確率、入賞の確率を計算してみましょう
        （Aさんがは134点を取る確率が1/5、などと単純に考えてみましょう）

---

### 計算結果

- 単純に考えるとこうなる
    - Aさん: ほぼ1/5の確率で入賞
    - Bさん: ほぼ1/4の確率で優勝
    - Cさん: ほぼ3/5の確率で入賞
- 前回よりは話し合う材料が増えたけど・・・
    - 点数の確率をこんなふうに計算していいのか？（特にBさん）
        - この話題はあとまわし（第3回以降）
    - <span style="color:red">優勝と入賞ってどれくらい価値があるの？</span>

---

## 期待値ってなに

---

### 期待値

- （雑な）定義: なにかばらつく値の平均値を推定、予想した値
    - 問題: 3700円を払い、サイコロの出目に1000をかけただけお金がかえってくるギャンブルがありますが、1回の試行で儲かるお金の期待値は？

---

## 答え

- $1000/6 + 1000\cdot 2/6 + 1000\cdot 3/6 + 1000\cdot 4/6$
$+ 1000 \cdot 5/6 + 1000 \cdot 6/6 - 3700 = 1000(3.5) - 3700$ <span style="color:red">$= -200$</span>


---

### 意思決定における期待値の意義

- 何かを決めたらどれだけ見返りが戻ってくるかを数値（特にお金）で考えられる
- 例
    - ケース1: 優勝賞金10万円、2位以下で入賞の場合5万円
    - ケース2: 優勝賞金10万円、2位以下で入賞の場合1万円

---

### 計算

- 期待値の計算
    - ケース1: 優勝賞金10万円、2位以下で入賞の場合5万円
    - ケース2: 優勝賞金10万円、2位以下で入賞の場合1万円

|確率|ケース1|ケース2|
|:--:|:----:|:----:|
|Aさん: ほぼ1/5の確率で入賞 | $1/5\times \ \ 50,000 = 10,000$円 | $\ \ 2,000$円|
|Bさん: ほぼ1/4の確率で優勝 | $1/4\times 100,000 = 25,000$円 | <span style="color:red">$25,000$円</span>|
|Cさん: ほぼ3/5の確率で入賞 | <span style="color:red">$3/5\times \ \ 50,000 = 30,000$円</span> | $\ \ 6,000$円 |

<center>（当然ながら）賞金で選考基準が変化</center>

---

### これまでのまとめ

- 結局、なにか見返りを考えないと判断はできない
    - 期待値はその基本
- まだちょっとスッキリしないけど、ボーリングの話はこれで終わり

---

### 期待値の計算

- 基本
    - 事象A, B, C, ..., Eが互いに排反で、A〜Eでない事象の起こる確率が0とすると
    - 期待値 = $\text{Pr}\{\text{A}\}f(\text{A}) + \text{Pr}\{\text{B}\}f(\text{B}) + \cdots \text{Pr}\{\text{E}\}f(\text{E})$
        - $f$が、なにか事象にたいしてお金などを決める関数
    - 数式で書くとややこしいけど、さっきのお金の計算を思い出しましょう
- 平均値も期待値
    - $f$を何にするとよいでしょうか？

---

### 問題を解きましょう

- [3つのサイコロのうち2つ以上が揃う確率](https://b.ueda.tech/?page=robot_and_stats_questions#%E7%A2%BA%E7%8E%87%E3%81%AE%E9%9B%91%E5%A4%9A%E3%81%AA%E5%95%8F%E9%A1%8C1)

---

## まとめ

- 確率と期待値を勉強
- 期待値があると意思決定ができる（すべての意思決定ができるわけではない）


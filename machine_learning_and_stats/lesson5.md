---
marp: true
---

<!-- footer: "機械学習（と統計）第5回" -->

# 機械学習

## 第5回: ベイズの定理と推定

千葉工業大学 上田 隆一

<br />

<span style="font-size:70%">This work is licensed under a </span>[<span style="font-size:70%">Creative Commons Attribution-ShareAlike 4.0 International License</span>](https://creativecommons.org/licenses/by-sa/4.0/).
![](https://i.creativecommons.org/l/by-sa/4.0/88x31.png)

---

<!-- paginate: true -->

## 今日やること

- クイズ
- ベイズの定理

---

## クイズ

- なんのことをいっているのでしょう？ヒントをひとつずつ出すので候補をいろいろ書いてみてください。
    * 上に卵が乗っていることがある
    * スープに入っている
    * 日本人はズルズルいわせて食べる
    * 白い

---

### クイズの答えと、答えより重要なこと

- たぶん「うどん」が正解
    - ほかにあるかもしれませんが
- 答えよりも重要なこと: 我々の頭のなかはどうなってる？
    - 脳細胞がなにをやっているかはこの講義の範囲を超える
    - なんとなく「確率」を使ってないでしょうか？
    （どうやって使っているか議論してみましょう）

---

### 連想ゲームと確率の計算

- たとえばこの状態のとき、「白い」を教えられたらどうなるか
    - うどん: 40%
    - そば: 60%（ 関東なのでそば強めで👈これもあとから議論）
- 「白い」を教えられたあとの確率は条件付き確率（2回目で出てきたやつ）
で表記できる
    - Pr$\{$うどん$|$白い$\}$
    - Pr$\{$そば$|$白い$\}$

<center>表記はできるけど計算は？</center>

---

### これで計算できる（理屈はあとで）

- 乗法定理とよく似ているが違う式で計算
    - $\text{Pr}\{$うどん$|$白い$\} =\eta\text{Pr}\{$白い$|$うどん$\}\text{Pr}\{$うどん$\}$
    - $\text{Pr}\{$そば$|$白い$\} =\eta\text{Pr}\{$白い$|$そば$\}\text{Pr}\{$そば$\}$
    - $\eta$は上記2つの確率の和が1になる確率
- 以下の数値で計算してみましょう
    - $\text{Pr}\{$うどん$\} = 0.4$、$\text{Pr}\{$そば$\} = 0.6$
    - $\text{Pr}\{$白い$|$うどん$\} = 0.99$、$\text{Pr}\{$白い$|$そば$\} = 0.1$
        - 補足: 白いそばもある
    - 答えは次ページ


---

### 答え

- とりあえず$\eta$以外を計算
    - $\text{Pr}\{$うどん$|$白い$\} =\eta 0.99 \cdot 0.4= 0.396\eta$
    - $\text{Pr}\{$そば$|$白い$\} =\eta 0.1 \cdot 0.6 = 0.06\eta$
- $0.396\eta + 0.06\eta = 1 \Longrightarrow \eta = 1/0.456$
- したがって
    - $\text{Pr}\{$うどん$|$白い$\} =0.396\eta = 0.396/0.456 \approx 0.87$
    - $\text{Pr}\{$そば$|$白い$\} = 0.06\eta = 0.06/0.456 \approx 0.13$

<center>「白い」という情報でうどんがそばを逆転</center>

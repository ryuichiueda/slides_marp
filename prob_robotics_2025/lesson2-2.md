---
marp: true
---

<!-- footer: 確率ロボティクス第2回（その2） -->

# 確率ロボティクス第2回（その2）: <br />確率変数，確率質量関数と確率分布

千葉工業大学 上田 隆一

<br />

<p style="font-size:50%">
This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
<img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a>
</p>

---

<!-- paginate: true -->

## 今回の内容

- 確率変数
- 確率質量関数
- 確率分布
- 同時確率分布

---

## 確率変数

- 事象に数を対応させたもの
    - 例1: コインを投げて表が出る/裏が出るにそれぞれ$0$、$1$を割り当て
    - 例2（自然にそうなっている例）
        - サイコロを振って$n$の目が出る事象に$n$を割り当て
    - 例3（自然にそうなっている+連続的な変数の例）
        - ある人の身長が$x$[mm]であるという事象に$x$を割り当て
- 大抵は<span style="color:red">根元事象</span>に対して数値を対応
    - 根元事象: それ以上分けられない/分けない事象（サイコロの目など）
    - 確率変数の定義域は全ての根元事象を網羅している必要がある

---

### なんで確率変数を考えるのか

- 確率分布を考えるため（後述）
- その他計算のため（期待値など。次回。）
- 事象の扱いがめんどくさい
    - いちいち「$\circ\circ$という事象が起こった」と言うのがめんどくさい
    - 根元事象やそうでない事象が入り混じってめんどくさい
- 注意: 以後、区別の不要なときは、確率変数を単に「変数」と表記

---

## 確率分布

- 確率変数を横軸にすると確率のグラフが描ける
    - 数直線上での確率の「分布」が分かる$\Longrightarrow$<span style="color:red">確率分布</span>
- 典型的な分布には名前
    - <span style="color:red">ベルヌーイ分布</span>（例: (a)）
        - 変数が2値だけ
    - <span style="color:red">一様分布</span>（例: (b)）
        - 変数のある範囲で確率が一定

![bg right:50% 90%](./figs/prob_dist.png)

---

## 確率質量関数

- 変数の値に対応する確率を返す関数
    - 表記: $P(x)$（厳密には$P$）
    - 要は確率分布のグラフの形を決める関数
    - <span style="color:red">これも確率分布と呼ばれる</span>
- $\Pr\{$ $\}$より定義がスッキリ
    - 変数がスカラー
- 補足
    - 「$P$」という記号は、本来は$f$だろうが
    $g$だろうが別になんでもよい
    - $x$が実数のときは密度の関数になるが
    今は考えない

![bg right:35% 90%](./figs/prob_dist.png)


---

### 確率質量関数と加法定理

- 確率変数の場合、値が異なれば自動的に排反に
    - $\Pr\{a=x_1 \text{\ or\ } x_2 \} = P_a(x_1) + P_a(x_2)$
        - $x_1 \neq x_2$のとき
    - $\Pr\{\bigvee_{i=1}^n a=x_i \} = \sum_{i=1}^nP_a(x_i)$
        - 互いに異なる$x_{1:n}$に対して
    - $\Pr\{x_0 \le x \le x_1\} = \sum_{x=x_0}^{x_1} P(x)$
- 確率分布の一部の面積に相当

---

## 「確率分布に従う」

- 変数$x$が$P$で分布するとき、「$x$は$P$に従う」と表現
    - $P$がなんらかの法則性をあらわしていて、
    $x$はそれにしたがって発生するという発想
- 数式上の表記: $x \sim P$
    - 表記に関する補足
        - $P(x)$は変数の値が$x$となるときの確率
        - $P$は確率分布そのもの

---

## ドローイング

- $P$にしたがうように値をランダムに選択すること
- これも表記は$x \sim P$
- 無限に値をドローイングして確率分布を作ると$P$に一致
- 用途
    - 数値計算（モンテカルロ積分や一部のサンプリング手法）
    - シミュレーション
- 似て非なるもの: サンプリング
    - サンプリング: 統計を取るときに対象から
    一定数の標本（サンプル）を抜き取ること


---

## 独立同分布

- $x_1 \sim P$、$x_2 \sim P$とふたつ値をドローしたとき、
$x_1$と$x_2$に、$P$に従う以上の関係性がないこと
- 表記: $x_{1:n} \overset{\text{iid}}{\sim} P$
    - $x_1, x_2, \dots, x_n$が互いに独立同分布
- 「独立同分布」という分布はない（形容詞のように使う）
- 独立同分布にならない例
    - ディーラーが操作しているルーレットやトランプ
        - 「前がこうだったから次はこう」みたいな操作で独立同分布でなくなる
        - ディーラーがうまくやれば長期的な統計では$P$にしたがう
    - <span style="color:red">センサーの出力</span>
        - 雑音の要因は一定時間続く$\rightarrow$前後の出力には同じ傾向


---

## 同時分布

- 2つ以上の確率変数に対する分布
- 例: 青いサイコロの出目を$a$、赤いサイコロの出目を$b$とするとき
    - 出目の確率分布: $P_{a,b}$
    - $a=x, b=y$になる確率: $P_{a,b}(x,y)$
        - $P_{a,b}$は同時確率質量関数（分布）と呼ばれる
- なんの分布か分かっているときは$P_{a,b}$の添え字は省略されることが多い
    - $P$、$P(x,y)$
    - 教科書でこれをやると混乱する人も出る
    - ・・・けど、添え字だらけも読みにくい（悩ましい）


---

### 同時分布と乗法定理

- 乗法定理（そのまま成り立つ）
    - $P(x, y) = P(x|y)P(y)\qquad$（本当は$P_{a,b}(x, y) = P_{a|b}(x|y)P_{b}(y)$）
        - $P(x|y)$は条件付き確率質量関数（分布）と呼ばれる
    - 独立な場合: $P(x, y) = P(x)P(y)$
    - 互いに独立な$x_{1:n}$に対し: $P(x_1,x_2,\dots,x_n) = \prod_{i=1}^nP(x_i)$

---

### 同時分布の変数の追加・削除

- 変数の追加
    - $P(x)$があるときに、新たな変数$y$を考える
        - <span style="color:red">$P(x) = \sum_{y \in Y}P(x, y)$が成立</span>
            - ここで$Y= \{y_0, y_1, \dots, y_n\}$
    - 例: 前半のX君とY君の電源回路の話
        - $\Pr\{$ロボットが起動$\}$
            $=\Pr\{$ロボットが起動$|$X$\}\Pr\{$X$\} + \Pr\{$ロボットが起動$|$Y$\}\Pr\{$Y$\}$
- 同時分布から特定の変数を消す操作
    - 上の式の逆で$\sum_{y \in Y}P(x, y) = P(x)$
    - <span style="color:red">周辺化</span>と呼ばれ、アルゴリズムの導出でよく出てくる

---

## まとめ

- 確率について入門
    - $\Pr\{\quad\}$という記号
    - 乗法定理，加法定理
    - 独立，排反
    - 空事象，全事象
- 2つの定理を使った計算
    - 定理はたった2つだが、事象の扱いで頭をひねる必要がある

